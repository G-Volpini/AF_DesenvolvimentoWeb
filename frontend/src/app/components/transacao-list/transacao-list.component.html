<div class="list-wrapper">
  <!-- Header com Filtros Integrados -->
  <div class="list-header">
    <h3 class="list-title">Transações</h3>
    <div class="filters">
      <select class="filter-select" [(ngModel)]="filtroTipo" (change)="onFiltroChange()">
        <option value="">Todas</option>
        <option value="receita">Receitas</option>
        <option value="despesa">Despesas</option>
      </select>

      <select class="filter-select" [(ngModel)]="filtroCategoria" (change)="onFiltroChange()">
        <option value="">Categorias</option>
        <option *ngFor="let cat of todasCategorias" [value]="cat">{{ cat }}</option>
      </select>

      <button class="filter-clear" (click)="limparFiltros()" *ngIf="filtroTipo || filtroCategoria">
        Limpar
      </button>
    </div>
  </div>

  <!-- Lista de Transações -->
  <div class="list-content" *ngIf="transacoesFiltradas.length > 0; else semTransacoes">
    <div class="transaction-item" *ngFor="let transacao of transacoesFiltradas">
      
      <div class="transaction-main">
        <div class="transaction-info">
          <div class="transaction-header">
            <span class="transaction-desc">{{ transacao.descricao }}</span>
            <span class="transaction-badge" [style.background-color]="getCorCategoria(transacao.categoria)">
              {{ transacao.categoria }}
            </span>
          </div>
          <span class="transaction-date">{{ formatarData(transacao.data) }}</span>
        </div>

        <div class="transaction-right">
          <span class="transaction-value" [class.value-receita]="transacao.tipo === 'receita'"
            [class.value-despesa]="transacao.tipo === 'despesa'">
            {{ transacao.tipo === 'receita' ? '+' : '-' }} {{ formatarMoeda(transacao.valor) }}
          </span>
          <div class="transaction-actions">
            <button class="action-btn edit" (click)="editar(transacao)" title="Editar">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
            </button>
            <button class="action-btn delete" (click)="excluir(transacao._id)" title="Excluir">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #semTransacoes> <!-- Aqui so vai mostrar se nao tiver resultado aparente ao aplicar um filtro -->
    <div class="empty-state">
      <p class="empty-title">Nenhuma transação encontrada.</p>
      <p class="empty-text">Adicione sua primeira transação</p>
    </div>
  </ng-template>
</div>